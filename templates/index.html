<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Reddit Sentiment & Price Scanner</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; }
    table { border-collapse: collapse; margin-top: 1em; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 0.5em; text-align: center; }
    th { background-color: #f5f5f5; }
    textarea, input, button { font-size: 1em; padding: 0.5em; }
    textarea { width: 100%; box-sizing: border-box; }
    .yes { color: green; font-weight: bold; }
    .no { color: red; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Reddit Sentiment & Price Scanner</h1>
  <form method="post">
    <label>Tickers (CSV or one per line):</label><br>
    <textarea name="tickers" rows="5" placeholder="e.g.
TSLA, AAPL, MSFT
GOOG, AMZN"></textarea><br><br>

    <label>Hours back:</label>
    <input name="hours" type="number" min="1" max="168" value="{{ hours }}"><br><br>

    <button type="submit">Analyze</button>
  </form>

  {% if results %}
    <h2>Results (last {{ hours }} hours)</h2>
    <table>
      <tr>
        <th>Ticker</th>
        <th>Posts<br>(count, mean, +/n/-)</th>
        <th>Comments<br>(count, mean, +/n/-)</th>
        <th>Trade Today?</th>
        <th>% Change</th>
      </tr>
      {% for t, data in results.items() %}
      <tr>
        <td>{{ t }}</td>
        <td>
          {{ data.posts.count }}, mean {{ data.posts.mean|round(2) }},<br>
          +{{ data.posts.pos }}/n{{ data.posts.neu }}/-{{ data.posts.neg }}
        </td>
        <td>
          {{ data.comments.count }}, mean {{ data.comments.mean|round(2) }},<br>
          +{{ data.comments.pos }}/n{{ data.comments.neu }}/-{{ data.comments.neg }}
        </td>
        <td class="{{ 'yes' if data.recommend == 'Yes' else 'no' }}">
          {{ data.recommend }}
        </td>
        <td>{{ data.change }}%</td>
      </tr>
      {% endfor %}
    </table>
  {% endif %}
</body>
</html>
